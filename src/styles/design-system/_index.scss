// ==========================================================================
// Design System Main Index
// ==========================================================================
//
// Complete design system using modern @use/@forward architecture.
// This is the single entry point for the entire design system.
//
// Usage:
//   @use "design-system" as ds;
//
//   .my-component {
//     background: ds.$color-primary;
//     padding: ds.$space-4;
//   }
//

// ==========================================================================
// Core Imports
// ==========================================================================

// Import and re-export all design system modules
@use 'tokens' as tokens;
@use 'foundation' as foundation;
@use 'components/atoms' as atoms;
@use 'components/molecules' as molecules;
@use 'components/organisms' as organisms;
@use 'components/layouts' as layouts;
@use 'components/pages' as pages;

// ==========================================================================
// Public API Exports
// ==========================================================================

// Export all modules for external consumption
@forward 'tokens';
@forward 'foundation';
@forward 'components/atoms';
@forward 'components/molecules';
@forward 'components/organisms';
@forward 'components/layouts';
@forward 'components/pages';

// ==========================================================================
// Global Design System Initialization
// ==========================================================================

// This section applies the design system globally when imported
// All CSS custom properties and base styles are applied to :root

// The design system is automatically initialized when this file is imported
// No additional setup is required - just import this file in your main SCSS

// ==========================================================================
// Design System Metadata
// ==========================================================================

// Design system information for documentation and debugging
$design-system-version: '1.0.0' !default;
$design-system-name: 'A11y Crawl & Test Design System' !default;

// Feature flags for optional functionality
$enable-responsive-utilities: true !default;
$enable-print-styles: true !default;
$enable-animations: true !default;
$enable-dark-mode: false !default; // Future enhancement

// ==========================================================================
// Optional Responsive Utilities
// ==========================================================================

@if $enable-responsive-utilities {
  // Generate responsive variants of key utilities
  $breakpoints: (
    sm: 576px,
    md: 768px,
    lg: 992px,
    xl: 1200px,
    xxl: 1400px,
  );

  @each $name, $value in $breakpoints {
    @media (min-width: #{$value}) {
      // Responsive display utilities
      .d-#{$name}-none {
        display: none !important;
      }
      .d-#{$name}-block {
        display: block !important;
      }
      .d-#{$name}-flex {
        display: flex !important;
      }
      .d-#{$name}-grid {
        display: grid !important;
      }

      // Responsive text alignment
      .text-#{$name}-left {
        text-align: left !important;
      }
      .text-#{$name}-center {
        text-align: center !important;
      }
      .text-#{$name}-right {
        text-align: right !important;
      }

      // Responsive spacing utilities (selection)
      .m-#{$name}-0 {
        margin: var(--space-0) !important;
      }
      .m-#{$name}-4 {
        margin: var(--space-4) !important;
      }
      .p-#{$name}-0 {
        padding: var(--space-0) !important;
      }
      .p-#{$name}-4 {
        padding: var(--space-4) !important;
      }
    }
  }
}

// ==========================================================================
// Optional Print Styles
// ==========================================================================

@if $enable-print-styles {
  @media print {
    // Hide non-essential elements
    .btn,
    .form-control,
    .card-actions {
      display: none !important;
    }

    // Optimize text for print
    body {
      color: black !important;
      background: white !important;
    }

    // Ensure links are visible
    a {
      color: black !important;
      text-decoration: underline !important;
    }

    // Remove shadows and transitions
    * {
      box-shadow: none !important;
      transition: none !important;
    }

    // Optimize cards for print
    .card {
      border: 1px solid black !important;
      break-inside: avoid;
    }

    // Show link URLs after text
    a[href]:not(.btn):not(.nav-link)::after {
      content: ' (' attr(href) ')';
      font-size: 0.875em;
      color: #666;
    }
  }
}

// ==========================================================================
// Optional Animation Controls
// ==========================================================================

@if $enable-animations {
  // Provide a way to disable animations globally
  .no-animations,
  .no-animations * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }

  // Enhanced focus animations for better accessibility
  @keyframes focus-pulse {
    0%,
    100% {
      opacity: 1;
    }
    50% {
      opacity: 0.7;
    }
  }

  .focus-pulse:focus-visible {
    animation: focus-pulse 2s ease-in-out infinite;
  }
}

// ==========================================================================
// Component Registration
// ==========================================================================

// Register components for potential JavaScript interaction
// This creates a global registry of available components

:root {
  --design-system-version: #{$design-system-version};
  --design-system-name: '#{$design-system-name}';

  // Component availability flags
  --has-buttons: 'true';
  --has-forms: 'true';
  --has-cards: 'true';
  --has-accordions: 'true';
  --has-layout-system: 'true';
}

// ==========================================================================
// Development Helpers
// ==========================================================================

// Debug mode for development (controlled by build system)
$debug-mode: false !default;

@if $debug-mode {
  // Visual debugging helpers
  .debug-grid {
    background-image:
      linear-gradient(rgba(255, 0, 0, 0.1) 1px, transparent 1px),
      linear-gradient(90deg, rgba(255, 0, 0, 0.1) 1px, transparent 1px);
    background-size: var(--space-4) var(--space-4);
  }

  .debug-spacing * {
    outline: 1px solid rgba(255, 0, 0, 0.3) !important;
  }

  // Log design system load
  body::before {
    content: 'Design System #{$design-system-version} Loaded';
    position: fixed;
    top: 0;
    right: 0;
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: var(--space-2) var(--space-3);
    font-size: var(--font-size-xs);
    z-index: 99999;
    pointer-events: none;
  }
}

// ==========================================================================
// Performance Optimizations
// ==========================================================================

// Use contain property for better rendering performance
.card,
.btn,
.form-group {
  contain: layout style;
}

// Optimize accordion animations
.accordion-content {
  contain: layout;
}

// Optimize grid layouts
.grid,
.layout-two-column,
.layout-three-column {
  contain: layout;
}

// ==========================================================================
// Future Enhancements Placeholder
// ==========================================================================

// Placeholder for dark mode support
@if $enable-dark-mode {
  @media (prefers-color-scheme: dark) {
    :root {
      // Dark mode color overrides would go here
      // This is prepared for future implementation
      --color-background-primary: #1a1a1a;
    }
  }

  .theme-dark {
    // Explicit dark mode class overrides would go here
    --color-background-primary: #1a1a1a;
  }
}

// ==========================================================================
// Testing and Development Utilities
// ==========================================================================

// Export testing utilities for development builds
// Note: Testing utilities are included separately
// @use "testing/testing";
